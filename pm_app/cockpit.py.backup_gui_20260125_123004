from dash import Dash, html, dcc
import os, time

app = Dash(__name__)
app.title = "Project Aion — Glass Cockpit (Framework Only)"
server = app.server

def build_stamp():
    try:
        mtime = os.path.getmtime(__file__)
        stamp = f"{os.path.basename(__file__)} • {time.strftime('%Y-%m-%d %H:%M:%S', time.localtime(mtime))}"
    except Exception:
        stamp = "unknown"
    return html.Div(
        f"BUILD: {stamp}",
        style={
            "position": "fixed",
            "bottom": "6px",
            "right": "10px",
            "zIndex": 9999,
            "fontFamily": "Arial",
            "fontSize": "11px",
            "opacity": 0.7,
            "background": "rgba(255,255,255,0.9)",
            "padding": "3px 8px",
            "borderRadius": "10px",
            "border": "1px solid #ddd",
        },
    )

def card(title, value, note=""):
    return html.Div(
        [
            html.Div(title, style={"fontSize":"12px","opacity":0.75}),
            html.Div(value, style={"fontSize":"26px","fontWeight":"900","marginTop":"6px"}),
            html.Div(note, style={"fontSize":"12px","opacity":0.7,"marginTop":"8px"}) if note else None,
        ],
        style={
            "border":"1px solid #ddd",
            "borderRadius":"16px",
            "padding":"14px",
            "boxShadow":"0 2px 12px rgba(0,0,0,0.06)",
            "background":"white",
            "minHeight":"110px",
        },
    )

def panel(title, children):
    return html.Div(
        [
            html.Div(title, style={"fontWeight":"900","marginBottom":"10px"}),
            children,
        ],
        style={
            "border":"1px solid #ddd",
            "borderRadius":"16px",
            "padding":"14px",
            "boxShadow":"0 2px 12px rgba(0,0,0,0.06)",
            "background":"white",
        },
    )

app.layout = html.Div(
    style={"fontFamily":"Arial", "background":"#f6f7f9", "minHeight":"100vh"},
    children=[
        html.Div(
            style={
                "position":"sticky","top":"0","zIndex":"5",
                "background":"rgba(246,247,249,0.95)",
                "backdropFilter":"blur(6px)",
                "borderBottom":"1px solid #e3e5e8",
                "padding":"14px 18px",
                "display":"flex","alignItems":"center","justifyContent":"space-between",
            },
            children=[
                html.Div(
                    [
                        html.Div("Project Aion", style={"fontSize":"12px","opacity":0.75}),
                        html.Div("Glass Cockpit — GUI Framework", style={"fontSize":"20px","fontWeight":"900"}),
                    ]
                ),
                html.Div(
                    [
                        dcc.Link("Open PM System (:8050)", href="http://127.0.0.1:8050/", style={"marginRight":"14px"}),
                        html.Span("Framework-only", style={"fontSize":"12px","opacity":0.75}),
                    ]
                ),
            ],
        ),

        html.Div(
            style={"display":"grid","gridTemplateColumns":"240px 1fr","gap":"12px","padding":"12px 18px"},
            children=[
                html.Div(
                    style={
                        "border":"1px solid #ddd","borderRadius":"16px","padding":"14px",
                        "boxShadow":"0 2px 12px rgba(0,0,0,0.06)","background":"white",
                        "height":"calc(100vh - 92px)","position":"sticky","top":"78px",
                    },
                    children=[
                        html.Div("Navigation (placeholder)", style={"fontWeight":"900","marginBottom":"10px"}),
                        html.Div("• Cockpit Home", style={"marginBottom":"6px"}),
                        html.Div("• Trading Console Frame", style={"marginBottom":"6px"}),
                        html.Div("• Risk / Alerts", style={"marginBottom":"6px"}),
                        html.Div("• System Status", style={"marginBottom":"6px"}),
                        html.Hr(),
                        html.Div("Rule", style={"fontWeight":"900","marginBottom":"8px"}),
                        html.Div("No data loading in :8051. Pure GUI shell.", style={"fontSize":"12px","opacity":0.75}),
                    ],
                ),

                html.Div(
                    children=[
                        html.Div(
                            style={"display":"grid","gridTemplateColumns":"repeat(4, 1fr)","gap":"12px","marginBottom":"12px"},
                            children=[
                                card("Frame", "READY", "Header/nav/cards layout"),
                                card("Panels", "READY", "Primary + secondary regions"),
                                card("Widgets", "NEXT", "Status lights, gauges, tiles"),
                                card("Theme", "NEXT", "Your cockpit styling pass"),
                            ],
                        ),

                        html.Div(
                            style={"display":"grid","gridTemplateColumns":"1.2fr 0.8fr","gap":"12px"},
                            children=[
                                panel(
                                    "Primary Panel (framework)",
                                    html.Div(
                                        [
                                            html.Div("This is where your cockpit visualization modules plug in.", style={"opacity":0.75}),
                                            html.Div("We keep the shell stable; swap content behind it.", style={"marginTop":"8px","opacity":0.75}),
                                        ]
                                    ),
                                ),
                                panel(
                                    "Secondary Panel (alerts / actions)",
                                    html.Ul(
                                        [
                                            html.Li("Alert styling placeholder"),
                                            html.Li("Action list placeholder"),
                                            html.Li("Status strip placeholder"),
                                        ],
                                        style={"marginTop":"0"},
                                    ),
                                ),
                            ],
                        ),
                    ]
                ),
            ],
        ),

        build_stamp(),
    ],
)

if __name__ == "__main__":
    app.run(host="127.0.0.1", port=8051, debug=False)
